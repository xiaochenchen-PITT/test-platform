package com.cxc.test.platform.migration.controller;

import com.cxc.test.platform.common.domain.AmisResult;
import com.cxc.test.platform.common.domain.diff.DiffResult;
import com.cxc.test.platform.infra.config.DbConfig;
import com.cxc.test.platform.migration.domain.CustomizedMethod;
import com.cxc.test.platform.migration.domain.config.MigrationCheckConfig;
import com.cxc.test.platform.migration.domain.config.MigrationConfig;
import com.cxc.test.platform.migration.domain.locate.SourceLocator;
import com.cxc.test.platform.migration.domain.mapping.MappingRule;
import com.cxc.test.platform.migration.domain.mapping.SourceMappingItem;
import com.cxc.test.platform.migration.domain.mapping.TargetMappingItem;
import com.cxc.test.platform.migration.service.MigrationCheckService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.*;

import javax.annotation.Resource;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

@Slf4j
@CrossOrigin
@RestController
@RequestMapping(value = "/migrationCheck")
public class OneIdMigrationCheckController extends MigrationCheckBaseController {

    @Resource
    DbConfig dbConfig;

    @Resource
    MigrationCheckService migrationCheckService;

    public final ExecutorService singleExecutorService = Executors.newFixedThreadPool(1);

    // config的格式：表1@字段1,字段2,...,字段n;表2@字段1,字段2,...,字段n
    // /testCbgCrm?env=test&config=table1@f1,f2;table2@f3,f4
    @RequestMapping(value = "/testCbgCrm", method = RequestMethod.GET)
    public AmisResult testCbgCrm(@RequestParam(value = "env") String env, @RequestParam(value = "config", required = false) String config,
                                 @RequestParam(value = "limit", required = false) Integer limit) {
        String triggerUrl = buildTriggerUrl();

        // init migration check config
        MigrationCheckConfig migrationCheckConfig = parseConfig(config);

        // init mapping config
        MigrationConfig migrationConfig = new MigrationConfig();

        migrationConfig.setSourceDbConfig(dbConfig.getScmDatabaseConfig(env, true));
        migrationConfig.setTargetDbConfig(dbConfig.getCrmDatabaseConfig(env, "cbg"));

        // 一大堆mapping rule字段对应关系
        addMappingRuleForCbgCrm_t_bb_company(migrationConfig);
        addMappingRuleForCbgCrm_t_bb_company_balance_account(migrationConfig);
        addMappingRuleForCbgCrm_t_bb_company_info(migrationConfig);
        addMappingRuleForCbgCrm_t_bb_company_link(migrationConfig);
        addMappingRuleForCbgCrm_t_bb_company_role(migrationConfig);
        addMappingRuleForCbgCrm_t_bb_company_voucher(migrationConfig);

        // 源数据初始化
        String sqlLimit = buildSqlLimitClause(limit);

        Map<String, String> tableAndSourceInitSqlMap = new HashMap<>();
        tableAndSourceInitSqlMap.put("t_bb_company", String.format("select * from t_bb_company %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_bb_company_balance_account", String.format("select * from t_bb_company_balance_account %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_bb_company_info", String.format("select * from t_bb_company_info %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_bb_company_link", String.format("select * from t_bb_company_link %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_bb_company_role", String.format("select * from t_bb_company_role %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_bb_company_voucher", String.format("select * from t_bb_company_voucher %s", sqlLimit));
        migrationConfig.setTableAndSourceInitSqlMap(tableAndSourceInitSqlMap);

        // 目标表中原表主键id定位
        SourceLocator locator = SourceLocator.builder()
            .locateField("biz_features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build();
        Map<String, SourceLocator> tableAndLocatorMap = new HashMap<>();
        for (MappingRule mappingRule : migrationConfig.getValidMappingRuleList()) {
            tableAndLocatorMap.put(mappingRule.getTargetMappingItem().getTableName(), locator);
        }
        migrationConfig.setTableAndLocatorMethodMap(tableAndLocatorMap);

        Long batchId = System.currentTimeMillis();
        singleExecutorService.submit(() -> {
            DiffResult diffResult = migrationCheckService.compare(batchId, migrationConfig, migrationCheckConfig, triggerUrl);
//        System.out.println(diffResult);
        });

        String retInfo = String.format("starting migration check, env: %s, limit: %s, please check later with batch id: %s", env, limit, batchId);
        return AmisResult.simpleSuccess(retInfo);
    }

    private void addMappingRuleForCbgCrm_t_bb_company_voucher(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_voucher")
                .fieldName("Fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_voucher")
                .fieldName("Fimg_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_attachment")
                .fieldName("file_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_voucher")// TODO: 2022/9/22 可能需要转换
                .fieldName("Fimg_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_attachment")
                .fieldName("file_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_voucher")
                .fieldName("Fimg_url")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_attachment")
                .fieldName("file_url")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_voucher")
                .fieldName("Fis_delete")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_attachment")
                .fieldName("is_deleted")
                .build())
            .build());
    }

    private void addMappingRuleForCbgCrm_t_bb_company_role(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_role")
                .fieldName("Fcompany_id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_role")
                .fieldName("Frole_status")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("status")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_role")
                .fieldName("Finfo_auditor_aid_list")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_principal")
                .fieldName("principal_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_role")
                .fieldName("Finfo_author_name_list")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_principal")
                .fieldName("principal_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_role")
                .fieldName("Fcompany_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_mapping")
                .fieldName("business_customer_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_role")
                .fieldName("Fshop_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("buyer_id")
                .build())
            .build());
    }

    private void addMappingRuleForCbgCrm_t_bb_company_link(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Flink_id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Flink_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Flink_position")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("position")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Flink_mobile")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("phone")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Flink_mail_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("email")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Fdefault_link")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("defaultLink"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Fis_delete")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("is_deleted")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Fcreater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_link")
                .fieldName("Fupdater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company_link")
//                .fieldName("Fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_contact")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company_link")
//                .fieldName("Fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_contact")
//                .fieldName("update_time")
//                .build())
//            .build());
    }

    private void addMappingRuleForCbgCrm_t_bb_company_info(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcompany_info_id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcompany_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_common")
                .fieldName("one_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcompany_class")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_type")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmCbgEnterpriseTypeCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcompany_kind")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_nature")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmCbgEnterpriseNatureCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Flegal_person")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_enterprise_sensitive_info")
                .fieldName("legal_person")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fbusiness_license_num")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("business_license")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Ftax_regist_num")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_credit_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcountry_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("country_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fprovince_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("province_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcity_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("city_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Farea_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("area_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Foffice_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("office_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcompany_mail_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_email")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcompany_fax")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_fax")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcompany_fix_tel")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_mobile")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fis_inside_subject")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("isInsideSubject"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fis_outside")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("supplier_domicile")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmCbgIsOutsideCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fcreater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("Fupdater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company_info")
//                .fieldName("Fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_company_info")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company_info")
//                .fieldName("Fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_company_info")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("registeredCountry")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("register_county_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("taxesType")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("taxes_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_info")
                .fieldName("organizationType")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("organization_type")
                .build())
            .build());
    }

    private void addMappingRuleForCbgCrm_t_bb_company_balance_account(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Faccount_id")
                .isPrimaryKey(true)
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder() todo 检查这个
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company_balance_account")
//                .fieldName("Fcompany_type")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName()
//                .fieldName()
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fpayee_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("account_type")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmCbgAccountTypeCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fis_oversea_payee")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("is_overseas")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fpayee_account")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("bank_account")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fpayee_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("user_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fpayee_bank_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("bank_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fbank_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("bank_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fswift_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("swift_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fdefault_account")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("defaultAccount"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fremark")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("remark"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fcreater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("Fupdater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company_balance_account")
//                .fieldName("Fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_bank")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company_balance_account")
//                .fieldName("Fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_bank")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company_balance_account")
                .fieldName("settlementCurrency")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("settlement_currency")
                .build())
            .build());
    }

    private void addMappingRuleForCbgCrm_t_bb_company(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fcompany_id")
                .isPrimaryKey(true)
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company")
//                .fieldName("Ftenant_id")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName() // 需要同步到新db的每一张表的tenant_id字段，统一测 group一下值好了
//                .fieldName()
//                .build())
//            .isCompareKey(false)
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fcompany_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fcompany_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_common")
                .fieldName("name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fcompany_for_short")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_abbreviation_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fcompany_for_short")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_common")
                .fieldName("short_name")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company")
//                .fieldName("Fsyn_company_id")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_company_info")
//                .fieldName("biz_features")
//                .build())
//            .customizedMethod(CustomizedMethod.builder()
//                .beanName("containsJsonValue")
//                .args(Arrays.asList("synCompanyId"))
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fcreater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fcreater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_common")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fupdater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("modified_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_bb_company")
                .fieldName("Fupdater_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_common")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company")
//                .fieldName("Fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_company_info")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company")
//                .fieldName("Fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_common")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company")
//                .fieldName("Fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_company_info")
//                .fieldName("update_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_bb_company")
//                .fieldName("Fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_common")
//                .fieldName("update_time")
//                .build())
//            .build());
    }

    // config的格式：表1@字段1,字段2,...,字段n;表2@字段1,字段2,...,字段n
    @RequestMapping(value = "/testGbgCrm", method = RequestMethod.GET)
    public AmisResult testGbgCrm(@RequestParam(value = "env") String env, @RequestParam(value = "config", required = false) String config,
                               @RequestParam(value = "limit", required = false) Integer limit) {
        String triggerUrl = buildTriggerUrl();

        // init migration check config
        MigrationCheckConfig migrationCheckConfig = parseConfig(config);

        // init mapping config
        MigrationConfig migrationConfig = new MigrationConfig();
        migrationConfig.setSourceDbConfig(dbConfig.getXforceDatabaseConfig(env, "gbg"));
        migrationConfig.setTargetDbConfig(dbConfig.getCrmDatabaseConfig(env, "gbg"));

        addMappingRuleAndInitSqlForGbgCrm(migrationConfig, limit);

        // 目标表中原表主键id定位
        SourceLocator locator = SourceLocator.builder()
            .locateField("biz_features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build();
        Map<String, SourceLocator> tableAndLocatorMap = new HashMap<>();
        for (MappingRule mappingRule : migrationConfig.getValidMappingRuleList()) {
            tableAndLocatorMap.put(mappingRule.getTargetMappingItem().getTableName(), locator);
        }
        migrationConfig.setTableAndLocatorMethodMap(tableAndLocatorMap);

        Long batchId = System.currentTimeMillis();
        singleExecutorService.submit(() -> {
            DiffResult diffResult = migrationCheckService.compare(batchId, migrationConfig, migrationCheckConfig, triggerUrl);
//        System.out.println(diffResult);
        });

        String retInfo = String.format("starting migration check, env: %s, limit: %s, please check later with batch id: %s", env, limit, batchId);
        return AmisResult.simpleSuccess(retInfo);
    }

    // config的格式：表1@字段1,字段2,...,字段n;表2@字段1,字段2,...,字段n
    @RequestMapping(value = "/testGspCrm", method = RequestMethod.GET)
    public AmisResult testGspCrm(@RequestParam(value = "env") String env, @RequestParam(value = "config", required = false) String config,
                               @RequestParam(value = "limit", required = false) Integer limit) {
        String triggerUrl = buildTriggerUrl();

        // init migration check config
        MigrationCheckConfig migrationCheckConfig = parseConfig(config);

        // init mapping config
        MigrationConfig migrationConfig = new MigrationConfig();
        migrationConfig.setSourceDbConfig(dbConfig.getXforceDatabaseConfig(env, "gsp"));
        migrationConfig.setTargetDbConfig(dbConfig.getCrmDatabaseConfig(env, "gsp"));

        addMappingRuleAndInitSqlForGbgCrm(migrationConfig, limit);

        // 目标表中原表主键id定位
        SourceLocator locator = SourceLocator.builder()
            .locateField("biz_features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build();
        Map<String, SourceLocator> tableAndLocatorMap = new HashMap<>();
        for (MappingRule mappingRule : migrationConfig.getValidMappingRuleList()) {
            tableAndLocatorMap.put(mappingRule.getTargetMappingItem().getTableName(), locator);
        }
        migrationConfig.setTableAndLocatorMethodMap(tableAndLocatorMap);

        Long batchId = System.currentTimeMillis();
        singleExecutorService.submit(() -> {
            DiffResult diffResult = migrationCheckService.compare(batchId, migrationConfig, migrationCheckConfig, triggerUrl);
//        System.out.println(diffResult);
        });

        String retInfo = String.format("starting migration check, env: %s, limit: %s, please check later with batch id: %s", env, limit, batchId);
        return AmisResult.simpleSuccess(retInfo);
    }

    private void addMappingRuleAndInitSqlForGbgCrm(MigrationConfig migrationConfig, Integer limit) {
        // 一大堆mapping rule字段对应关系
        addMappingRuleForGbgCrm_t_channel(migrationConfig);
        addMappingRuleForGbgCrm_t_channel_extends(migrationConfig);
        addMappingRuleForGbgCrm_t_channel_liaison(migrationConfig);
        addMappingRuleForGbgCrm_t_payment_information(migrationConfig);
        addMappingRuleForGbgCrm_t_business_relation(migrationConfig);

        // 源数据初始化
        String sqlLimit = buildSqlLimitClause(limit);

        Map<String, String> tableAndSourceInitSqlMap = new HashMap<>();
        tableAndSourceInitSqlMap.put("t_channel", String.format("select * from t_channel %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_channel_extends", String.format("select * from t_channel_extends %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_channel_liaison", String.format("select * from t_channel_liaison %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_payment_information", String.format("select * from t_payment_information %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_business_relation", String.format("select * from t_business_relation %s", sqlLimit));
        migrationConfig.setTableAndSourceInitSqlMap(tableAndSourceInitSqlMap);

        return;
    }

    private void addMappingRuleForGbgCrm_t_business_relation(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_business_relation")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_business_relation")
                .fieldName("scene_business_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_business_relation")
                .fieldName("scene_business_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_business_relation")
                .fieldName("scene_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_business_relation")
                .fieldName("scene_type")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_business_relation")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_business_relation")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_business_relation")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_business_relation")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_business_relation")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_business_relation")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_business_relation")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_business_relation")
                .fieldName("modified_id")
                .build())
            .build());
    }

    private void addMappingRuleForGbgCrm_t_payment_information(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("business_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("one_Id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("gbg", "customer"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("pay_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("account_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("pay_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("user_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("pay_account")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("bank_account")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("pay_bank_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("bank_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("is_abroad")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("is_overseas")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("swift_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("swift_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_payment_information")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bank")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_payment_information")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_bank")
//                .fieldName("update_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_payment_information")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_bank")
//                .fieldName("create_time")
//                .build())
//            .build());
    }

    private void addMappingRuleForGbgCrm_t_channel_liaison(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("liaison_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("liaison_department")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("department")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("liaison_position")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("position")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("policy_level")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("policyLevel"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("crm_level")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("crmLevel"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("liaison_phone")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("phone")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("liaison_email")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("email")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("mark")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("remark")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("channel_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("one_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("gbg", "customer"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("creator_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_channel_liaison")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_contact")
//                .fieldName("create_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_channel_liaison")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_customer_contact")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_liaison")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_contact")
                .fieldName("gender")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("sex"))
                .build())
            .build());
    }

    private void addMappingRuleForGbgCrm_t_channel_extends(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("company_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("company_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("company_addr")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("company_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("tax_registration_no")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("company_tax_no")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("legal_person")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("legalPerson"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("business_license_no")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("businessLicenseNo"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("phone")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("company_phone")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("business_file_url")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("businessFileUrl"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("account_bank")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("invoiceBankName"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel_extends")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_bill")
                .fieldName("bank_account_no")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("invoiceBankAccount"))
                .build())
            .build());
    }

    private void addMappingRuleForGbgCrm_t_channel(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("one_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("gbg", "customer"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("channel_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("channel_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_common")
                .fieldName("name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("area_country_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("business_area")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("simple_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_abbreviation_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("simple_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_common")
                .fieldName("short_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("channel_attribute_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("customer_attribute_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("area_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("customer_area")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("company_logo_url")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("logo_url")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("is_company_listing")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("isCompanyListing", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("cooperate_model")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("cooperation_mode")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("is_pay_day")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("isPayDay", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("pay_day_number")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("payDayNumber", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("is_access")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("isAccess", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("channel_attribute_type_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("attribute_type_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("channel_level")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("channelLevel", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("charge_person_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_principal")
                .fieldName("principal_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("country_manager_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_principal")
                .fieldName("country_manager_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("status")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("status")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgStatusCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("audit_status")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("audit_status")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgAuditStatusCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("access_condition")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("access_requirement")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("creator_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_channel")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_company_info")
//                .fieldName("create_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_channel")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_company_info")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("business_information")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("annual_turnover")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgBusinessInformationCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("is_ka")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("is_ka")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgIsKaCheck")
                .args(Arrays.asList("gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("company_addr")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("office_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("buy_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("buyer_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("invitation_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_principal")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("invitationCode", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("bd_user_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_principal")
                .fieldName("principal_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("is_authentication")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("isAuthentication", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("authentication_time")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("authenticationTime", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("register_time")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("registerTime", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("channel_source")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("channelSource", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("library_province_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("province_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("library_city_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("city_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("library_area_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("area_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("biz_customer_label")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("bizCustomerLabel", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("audit_time")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGgbContainsJsonValue")
                .args(Arrays.asList("auditTime", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_customer_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgTChannelFeaturesCompare")
                .args(Arrays.asList("t_customer_info", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgTChannelFeaturesCompare")
                .args(Arrays.asList("t_company_info", "gbg"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_credit_code")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("businessLicenseNo"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_name")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("customerCompanyName"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_enterprise_sensitive_info")
                .fieldName("legal_person")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("legalPersonName"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_enterprise_sensitive_info")
                .fieldName("legal_person_identification")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("legalPersonIdCard"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_mobile")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("companyPhone"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_nature")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgFeatureCompanyTypeCheck")
                .args(Arrays.asList("companyType"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_size")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgFeatureCompanyScaleCheck")
                .args(Arrays.asList("companyScale"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_email")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("companyEmail"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_channel")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("organization_type")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("crmGbgFeatureChannelTypeCheck")
                .args(Arrays.asList("channelType"))
                .build())
            .build());
    }

    // config的格式：表1@字段1,字段2,...,字段n;表2@字段1,字段2,...,字段n
    @RequestMapping(value = "/testGbgSrm", method = RequestMethod.GET)
    public AmisResult testGbgSrm(@RequestParam(value = "env") String env, @RequestParam(value = "config", required = false) String config,
                               @RequestParam(value = "limit", required = false) Integer limit) {
        String triggerUrl = buildTriggerUrl();

        // init migration check config
        MigrationCheckConfig migrationCheckConfig = parseConfig(config);

        // init mapping config
        MigrationConfig migrationConfig = new MigrationConfig();
        migrationConfig.setSourceDbConfig(dbConfig.getXforceDatabaseConfig(env, "gbg"));
        migrationConfig.setTargetDbConfig(dbConfig.getSrmDatabaseConfig(env, "gbg"));

        addMappingRuleAndInitSqlForGbgSrm(migrationConfig, limit);

        // 目标表中原表主键id定位
        SourceLocator locator = SourceLocator.builder()
            .locateField("features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build();
        Map<String, SourceLocator> tableAndLocatorMap = new HashMap<>();
        for (MappingRule mappingRule : migrationConfig.getValidMappingRuleList()) {
            tableAndLocatorMap.put(mappingRule.getTargetMappingItem().getTableName(), locator);
        }
        migrationConfig.setTableAndLocatorMethodMap(tableAndLocatorMap);

        Long batchId = System.currentTimeMillis();
        singleExecutorService.submit(() -> {
            DiffResult diffResult = migrationCheckService.compare(batchId, migrationConfig, migrationCheckConfig, triggerUrl);
//        System.out.println(diffResult);
        });

        String retInfo = String.format("starting migration check, env: %s, limit: %s, please check later with batch id: %s", env, limit, batchId);
        return AmisResult.simpleSuccess(retInfo);
    }

    // config的格式：表1@字段1,字段2,...,字段n;表2@字段1,字段2,...,字段n
    @RequestMapping(value = "/testGspSrm", method = RequestMethod.GET)
    public AmisResult testGspSrm(@RequestParam(value = "env") String env, @RequestParam(value = "config", required = false) String config,
                               @RequestParam(value = "limit", required = false) Integer limit) {
        String triggerUrl = buildTriggerUrl();

        // init migration check config
        MigrationCheckConfig migrationCheckConfig = parseConfig(config);

        // init mapping config
        MigrationConfig migrationConfig = new MigrationConfig();
        migrationConfig.setSourceDbConfig(dbConfig.getXforceDatabaseConfig(env, "gsp"));
        migrationConfig.setTargetDbConfig(dbConfig.getSrmDatabaseConfig(env, "gsp"));

        addMappingRuleAndInitSqlForGbgSrm(migrationConfig, limit);

        // 目标表中原表主键id定位
        SourceLocator locator = SourceLocator.builder()
            .locateField("features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build();
        Map<String, SourceLocator> tableAndLocatorMap = new HashMap<>();
        for (MappingRule mappingRule : migrationConfig.getValidMappingRuleList()) {
            tableAndLocatorMap.put(mappingRule.getTargetMappingItem().getTableName(), locator);
        }
        migrationConfig.setTableAndLocatorMethodMap(tableAndLocatorMap);

        Long batchId = System.currentTimeMillis();
        singleExecutorService.submit(() -> {
            DiffResult diffResult = migrationCheckService.compare(batchId, migrationConfig, migrationCheckConfig, triggerUrl);
//        System.out.println(diffResult);
        });

        String retInfo = String.format("starting migration check, env: %s, limit: %s, please check later with batch id: %s", env, limit, batchId);
        return AmisResult.simpleSuccess(retInfo);
    }

    private void addMappingRuleAndInitSqlForGbgSrm(MigrationConfig migrationConfig, Integer limit) {
        // 一大堆mapping rule字段对应关系
        addMappingRuleForGbgSrm_t_supplier(migrationConfig);
        addMappingRuleForGbgSrm_t_supplier_bank(migrationConfig);
        addMappingRuleForGbgSrm_t_supplier_brand_relation(migrationConfig);
        addMappingRuleForGbgSrm_t_supplier_ext(migrationConfig);
        addMappingRuleForGbgSrm_t_contact(migrationConfig);

        // 源数据初始化
        String sqlLimit = buildSqlLimitClause(limit);

        Map<String, String> tableAndSourceInitSqlMap = new HashMap<>();
        tableAndSourceInitSqlMap.put("t_supplier", String.format("select * from t_supplier %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_supplier_bank", String.format("select * from t_supplier_bank %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_supplier_brand_relation", String.format("select * from t_supplier_brand_relation %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_supplier_ext", String.format("select * from t_supplier_ext %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_contact", String.format("select * from t_contact %s", sqlLimit));
        migrationConfig.setTableAndSourceInitSqlMap(tableAndSourceInitSqlMap);

        return;
    }

    private void addMappingRuleForGbgSrm_t_contact(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("phone")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_mobile")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("email")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_mail")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("subject")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("subject")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_contact")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_link_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_contact")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_link_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("biz_features")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("version")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("version")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_contact")
                .fieldName("is_deleted")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("is_deleted")
                .build())
            .build());
    }

    private void addMappingRuleForGbgSrm_t_supplier_ext(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("supplier_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("gbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("is_deleted")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("is_deleted")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier_ext")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier_ext")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("modified_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("version")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("version")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonObject")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_ext")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("enterprise_credit_code")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getJsonValueAndCompare")
                .args(Arrays.asList("SUPPLIER_EXT_MAIN.socialUniformCreditCode"))
                .build())
            .build());
    }

    private void addMappingRuleForGbgSrm_t_supplier_brand_relation(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("brand_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("brand_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("brand_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("brand_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("supplier_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("gbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("intent_terminal")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("authorize_terminal")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("authorized_xy")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("authorize_xy")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("non_exportable_countries")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("unauthorized_county_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("business_category")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("authorize_relation")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("is_deleted")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("is_deleted")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonObject")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("modified_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier_brand_relation")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_brand_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier_brand_relation")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_brand_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_brand_relation")
                .fieldName("version")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_brand_bg")
                .fieldName("version")
                .build())
            .build());
    }

    private void addMappingRuleForGbgSrm_t_supplier_bank(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("supplier_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("gbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("collection_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("payment_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("overseas_payee")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("overseas_payee")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("account_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("account_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("account_bank")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("deposit_bank")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("bank_account_number")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("bank_account")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("account_area")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("bank_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("bank_international_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("bank_international_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("is_deleted")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("is_deleted")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier_bank")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bank_info_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier_bank")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bank_info_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("modified_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("version")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("version")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier_bank")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("biz_features")
                .build())
            .build());
    }

    private void addMappingRuleForGbgSrm_t_supplier(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("id")
                .isPrimaryKey(true)
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_id_mapping")
                .fieldName("business_supplier_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("enterprise_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("name_alias")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("enterprise_abbreviation_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("seller_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_merchant_supplier_bg")
                .fieldName("seller_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("approval_status")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("audit_status")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("level")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_rate_level")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("office_address")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier")
//                .fieldName("update_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("creator_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("creator_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("modified_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("modified_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("version")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("version")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("is_deleted")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("is_deleted")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("features")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonObject")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_supplier")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier")
//                .fieldName("create_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("supplier_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("supplier_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("status")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_status")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("trade_platform_supplier_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("trade_platform_supplier_ids")
                .build())
            .build());
    }

    // config的格式：表1@字段1,字段2,...,字段n;表2@字段1,字段2,...,字段n
    @RequestMapping(value = "/testCbgSrm", method = RequestMethod.GET)
    public AmisResult testCbgSrm(@RequestParam(value = "env") String env, @RequestParam(value = "config", required = false) String config,
                               @RequestParam(value = "limit", required = false) Integer limit) {
        String triggerUrl = buildTriggerUrl();

        // init migration check config
        MigrationCheckConfig migrationCheckConfig = parseConfig(config);

        // init mapping config
        MigrationConfig migrationConfig = new MigrationConfig();

        migrationConfig.setSourceDbConfig(dbConfig.getScmDatabaseConfig(env, false));
        migrationConfig.setTargetDbConfig(dbConfig.getSrmDatabaseConfig(env, "cbg"));

        // 一大堆mapping rule字段对应关系
        addMappingRuleForCbgSrm_t_merchants_bank_invoice(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_company_link(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_cooperative_information(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_enterprise_domestic_info(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_enterprise_overseas_info(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_product_info(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_product_qualification(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_supplier_basic_info(migrationConfig);
        addMappingRuleForCbgSrm_t_merchants_supplier_subject_info(migrationConfig);

        // 源数据初始化
        String sqlLimit = buildSqlLimitClause(limit);

        Map<String, String> tableAndSourceInitSqlMap = new HashMap<>();
        tableAndSourceInitSqlMap.put("t_merchants_bank_invoice", String.format("select * from t_merchants_bank_invoice %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_company_link", String.format("select * from t_merchants_company_link %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_cooperative_information", String.format("select * from t_merchants_cooperative_information %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_enterprise_domestic_info", String.format("select * from t_merchants_enterprise_domestic_info %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_enterprise_overseas_info", String.format("select * from t_merchants_enterprise_overseas_info %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_product_info", String.format("select * from t_merchants_product_info %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_product_qualification", String.format("select * from t_merchants_product_qualification %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_supplier_basic_info", String.format("select * from t_merchants_supplier_basic_info %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_supplier_subject_info", String.format("select * from t_merchants_supplier_subject_info %s", sqlLimit));
        migrationConfig.setTableAndSourceInitSqlMap(tableAndSourceInitSqlMap);

        // 目标表中原表主键id定位
        SourceLocator locator = SourceLocator.builder()
            .locateField("features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build();
        Map<String, SourceLocator> tableAndLocatorMap = new HashMap<>();
        for (MappingRule mappingRule : migrationConfig.getValidMappingRuleList()) {
            tableAndLocatorMap.put(mappingRule.getTargetMappingItem().getTableName(), locator);
        }
        migrationConfig.setTableAndLocatorMethodMap(tableAndLocatorMap);

        Long batchId = System.currentTimeMillis();
        singleExecutorService.submit(() -> {
            DiffResult diffResult = migrationCheckService.compare(batchId, migrationConfig, migrationCheckConfig, triggerUrl);
//        System.out.println(diffResult);
        });

        String retInfo = String.format("starting migration check, env: %s, limit: %s, please check later with batch id: %s", env, limit, batchId);
        return AmisResult.simpleSuccess(retInfo);
    }

    private void addMappingRuleForCbgSrm_t_merchants_supplier_subject_info(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_subject_info")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_subject_info")
                .fieldName("fbasic_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_merchant_supplier_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("cbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_subject_info")
                .fieldName("fbbmall_user_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_merchant_supplier_bg")
                .fieldName("user_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_subject_info")
                .fieldName("fbbmall_supplier_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_merchant_supplier_bg")
                .fieldName("bbmall_supplier_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_subject_info")
                .fieldName("fcooperation_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("cooperation_type")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgCooperationTypeCheck")
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_supplier_basic_info(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_id_mapping")
                .fieldName("business_supplier_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("supplier_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_application_number")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_application_number")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_id_mapping")
                .fieldName("cbg_supplier_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fcredit_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("enterprise_credit_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("enterprise_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_abbreviation_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("enterprise_abbreviation_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fcompany_mobile")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_mobile")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fcountry")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("country_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fprovince")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("province_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fcity")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("city_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("farea")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("area_id")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("foffice_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("office_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fregister_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_register_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fenterprise_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fenterprise_property")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("enterprise_nature")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("flegal_person")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_enterprise_sensitive_info")
                .fieldName("legal_person")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("flegal_person_identification")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_enterprise_sensitive_info")
                .fieldName("legal_person_identification")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_source")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_source")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_domicle")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("supplier_domicile")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_supplier_basic_info")
//                .fieldName("fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_supplier_basic_info")
//                .fieldName("fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("faudit_time")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("audit_time")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fremark")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_remark")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fstatus")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_status")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("faudit_status")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("audit_status")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fuser_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("receive_user_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("freferrer")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("referrer")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("flegal_person_mobile")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_enterprise_sensitive_info")
                .fieldName("legal_person_mobile")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("flegal_person_mail")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_enterprise_sensitive_info")
                .fieldName("legal_person_mail")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fis_inside_subject")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("if_inside_subject")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("ferp_num")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("erp_num")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("ferp_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("erp_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fyy_erp_num")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("yy_erp_num")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fthird_party_opinion")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("audit_status")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fquatily_opinion")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("remark")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("fsupplier_enter_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_enter_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("review_rejection_userid")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("operator_userid")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("checkNotEmpty")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("review_rejection_username")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("operator_username")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("checkNotEmpty")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("pass_userid")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("operator_userid")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("pass_username")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("operator_username")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("tripartite_audit_time")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("operate_time")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("checkNotEmpty") // 有一对多的情况，目前程序无法支持（一行数据迁出同表多条数据）
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("tripartite_audit_userid")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("operator_userid")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("checkNotEmpty") // 有一对多的情况，目前程序无法支持（一行数据迁出同表多条数据）
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("tripartite_audit_username")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_audit_record_bg")
                .fieldName("operator_username")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("checkNotEmpty") // 有一对多的情况，目前程序无法支持（一行数据迁出同表多条数据）
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_supplier_basic_info")
                .fieldName("tenant_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier")
                .fieldName("tenant_id")
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_product_qualification(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("ftrade_mark_license")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.tradeMarkLicense"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("fbrand_qualifications")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.brandQualifications"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("fpurchase_link")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.purchaseLink"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("fauthorization")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.authorization"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("fcustoms_quarantine_report")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.customsQuarantineReport"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("fcustoms_payment_certificate")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.customsPaymentCertificate"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("fcustoms_declaration_form")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.customsDeclarationForm"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("ffood_business_license")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.foodBusinessLicense"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("ffood_business_license_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.foodBusinessLicenseOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_qualification")
                .fieldName("ffood_business_license_three_opinion")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("productQualification.foodBusinessLicenseThreeOpinion"))
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_product_info(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fbasic_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("cbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("flink_level")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("linkLevel"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fbrand_or_representative")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("brandOrRepresentative"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fcan_authorized")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canAuthorized"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fcategory")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("category")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fother_category")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("other_category")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fbrand")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("operate_brand_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fother_brand")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("other_operate_brand")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fmain_product")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("main_product")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fmain_goods_source")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("main_goods_source")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("fcooperation_mode")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("cooperationMode"))
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_product_info")
//                .fieldName("fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_product_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_product_info")
//                .fieldName("fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_product_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_product_info")
                .fieldName("trade_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_product_bg")
                .fieldName("trade_type")
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_enterprise_overseas_info(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fregistration_document")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.registrationDocument"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fauthorization_certificate")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.authorizationCertificate"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fauthorization_person_id_card")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.authorizationPersonIdCard"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fwhole_link_bank_auth")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.wholeLinkBankAuth"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("ftax_information_auth")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.taxInformationAuth"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fbank_open_account_auth")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.bankOpenAccountAuth"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fbrand_register_certificate")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.brandRegisterCertificate"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("flong_term_effective")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.longTermEffective"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fbusiness_license_start")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgNatureFileTimeCheck")
                .args(Arrays.asList("enterpriseOverseasInfo.businessLicenseStart"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fbusiness_license_end")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgNatureFileTimeCheck")
                .args(Arrays.asList("enterpriseOverseasInfo.businessLicenseEnd"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fregistration_document_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.registrationDocumentOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("flong_term_effective_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.longTermEffectiveOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fbusiness_license_start_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.businessLicenseStartOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fbusiness_license_end_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.businessLicenseEndOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fregistration_document_three_opinion")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.registrationDocumentThreeOpinion"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_overseas_info")
                .fieldName("fbank_open_account_auth_three_opinion")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseOverseasInfo.bankOpenAccountAuthThreeOpinion"))
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_enterprise_domestic_info(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("business_license")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicense"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("business_license_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicenseAddress"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("flong_term_effective")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.longTermEffective"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_start")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgNatureFileTimeCheck")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicenseStart"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_end")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgNatureFileTimeCheck")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicenseEnd"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("ftax_registration_certificate")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.taxRegistrationCertificate"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("flegal_person_id_card")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.legalPersonIdCard"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("ftrade_mark_license")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.tradeMarkLicense"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fregister_certificate")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.registerCertificate"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbus_registration_certificate")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.busRegistrationCertificate"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fpermit_open_bank_account")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.permitOpenBankAccount"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fannual_return")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.annualReturn"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("freserved_seal")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.reservedSeal"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fspecimen_sign")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.specimenSign"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicenseOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("flong_term_effective_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.longTermEffectiveOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_start_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgNatureFileTimeCheck")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicenseStartOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_end_old")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgNatureFileTimeCheck")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicenseEndOld"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("fbusiness_license_three_opinion")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.businessLicenseThreeOpinion"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_enterprise_domestic_info")
                .fieldName("flegal_person_id_card_three_opinion")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("nature_file")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("enterpriseDomesticInfo.legalPersonIdCardThreeOpinion"))
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_cooperative_information(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fbasic_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("cbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_accept_people")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_accept_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_group")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_group_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_referees")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_referees_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_introduce_reason")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_introduce_reason")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_introduce_details")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_introduce_details")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_rate")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_rate_file")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_grade")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_rate_level")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgRatingCheck")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_area")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_area")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fpurchase_principal")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("purchase_principal_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fremark")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("cooperative_remark")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_cooperative_information")
//                .fieldName("fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_cooperative_information")
//                .fieldName("fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fsupplier_category")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("supplier_category")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fjoint_operation_status")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_merchant_supplier_bg")
                .fieldName("supplier_business_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("fjoint_operation_principal")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_merchant_supplier_bg")
                .fieldName("joint_operation_principal_ids")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_cooperative_information")
                .fieldName("quality_rating")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bg")
                .fieldName("quality_rating")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("srmCbgRatingCheck")
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_company_link(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("flink_id")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("fcompany_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("cbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("flink_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("flink_position")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_position")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("flink_mobile")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_mobile")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("flink_mail_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("link_mail")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("fdefault_link")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("default_link")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("is_deleted")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("is_deleted")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("booleanCompare")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_company_link")
//                .fieldName("create_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_link_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("create_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("creator_id")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_company_link")
//                .fieldName("modify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_link_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_company_link")
                .fieldName("modify_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_link_bg")
                .fieldName("modified_id")
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrm_t_merchants_bank_invoice(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fbasic_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("cbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fbasic_id")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_invoice_bg")
                .fieldName("one_supplier_id")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("getOneIdAndCompare")
                .args(Arrays.asList("cbg", "supplier"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fpayment_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("payment_type")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("faccount_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("account_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fbank")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("bank_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fdeposit_bank")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("deposit_bank")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fbank_account")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("bank_account")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fremark")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("remark")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("foverseas_payee")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("overseas_payee")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fbank_international_code")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("bank_international_code")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fcompany_name")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_invoice_bg")
                .fieldName("invoice_company_name")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fcompany_duty_paragraph")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_invoice_bg")
                .fieldName("invoice_duty_paragraph")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fdeposit_bank_invoice")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_invoice_bg")
                .fieldName("invoice_deposit_bank")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fbank_account_invoice")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_invoice_bg")
                .fieldName("invoice_bank_account")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fcompany_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_invoice_bg")
                .fieldName("invoice_company_address")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fcompany_mobile")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_invoice_bg")
                .fieldName("invoice_company_mobile")
                .build())
            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_bank_invoice")
//                .fieldName("fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bank_info_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_bank_invoice")
//                .fieldName("fcreate_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_invoice_bg")
//                .fieldName("create_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_bank_invoice")
//                .fieldName("fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_bank_info_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
//        migrationConfig.addMappingRule(MappingRule.builder()
//            .sourceMappingItem(SourceMappingItem.builder()
//                .tableName("t_merchants_bank_invoice")
//                .fieldName("fmodify_time")
//                .build())
//            .targetMappingItem(TargetMappingItem.builder()
//                .tableName("t_supplier_invoice_bg")
//                .fieldName("update_time")
//                .build())
//            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_bank_invoice")
                .fieldName("fbank_address")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_bank_info_bg")
                .fieldName("bank_address")
                .build())
            .build());
    }

    // config的格式：表1@字段1,字段2,...,字段n;表2@字段1,字段2,...,字段n
    @RequestMapping(value = "/testCbgSrmServiceProvider", method = RequestMethod.GET)
    public AmisResult testCbgSrmServiceProvider(@RequestParam(value = "env") String env, @RequestParam(value = "config", required = false) String config,
                                              @RequestParam(value = "limit", required = false) Integer limit) {
        String triggerUrl = buildTriggerUrl();

        // init migration check config
        MigrationCheckConfig migrationCheckConfig = parseConfig(config);

        // init mapping config
        MigrationConfig migrationConfig = new MigrationConfig();

        migrationConfig.setSourceDbConfig(dbConfig.getScmDatabaseConfig(env, false));
        migrationConfig.setTargetDbConfig(dbConfig.getSrmDatabaseConfig(env, "cbg"));

        // 一大堆mapping rule字段对应关系
        addMappingRuleForCbgSrmServiceProvider_t_merchants_service_overseas(migrationConfig);
        addMappingRuleForCbgSrmServiceProvider_t_merchants_service_inland(migrationConfig);
        addMappingRuleForCbgSrmServiceProvider_t_merchants_service_clearance(migrationConfig);
        addMappingRuleForCbgSrmServiceProvider_t_merchants_service_agency(migrationConfig);
        addMappingRuleForCbgSrmServiceProvider_t_merchants_business_info(migrationConfig);

        // 源数据初始化
        String sqlLimit = buildSqlLimitClause(limit);

        Map<String, String> tableAndSourceInitSqlMap = new HashMap<>();
        tableAndSourceInitSqlMap.put("t_merchants_service_overseas", String.format("select * from t_merchants_service_overseas %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_service_inland", String.format("select * from t_merchants_service_inland %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_service_clearance", String.format("select * from t_merchants_service_clearance %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_service_agency", String.format("select * from t_merchants_service_agency %s", sqlLimit));
        tableAndSourceInitSqlMap.put("t_merchants_business_info", String.format("select * from t_merchants_business_info %s", sqlLimit));
        migrationConfig.setTableAndSourceInitSqlMap(tableAndSourceInitSqlMap);

        // 目标表中原表主键id定位，部分表要加上service_type = x
        Map<String, SourceLocator> tableAndLocatorMap = new HashMap<>();
        tableAndLocatorMap.put("t_supplier_service_info_bg", SourceLocator.builder()
            .locateField("features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("serviceProviderLocate")
                .build())
            .build());
        tableAndLocatorMap.put("t_business_evaluation_info_bg", SourceLocator.builder()
            .locateField("features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build());
        tableAndLocatorMap.put("t_company_info", SourceLocator.builder()
            .locateField("features")
            .locateMethod(CustomizedMethod.builder()
                .beanName("jsonExtractSourceId")
                .build())
            .build());
        migrationConfig.setTableAndLocatorMethodMap(tableAndLocatorMap);

        Long batchId = System.currentTimeMillis();
        singleExecutorService.submit(() -> {
            DiffResult diffResult = migrationCheckService.compare(batchId, migrationConfig, migrationCheckConfig, triggerUrl);
//        System.out.println(diffResult);
        });

        String retInfo = String.format("starting migration check, env: %s, limit: %s, please check later with batch id: %s", env, limit, batchId);
        return AmisResult.simpleSuccess(retInfo);
    }

    private void addMappingRuleForCbgSrmServiceProvider_t_merchants_service_overseas(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fwarehouse_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("warehouseNature"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fcooperative_client")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("cooperativeClient"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("forder_cargo")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("orderCargo"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("findividuation_services")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("individuationServices"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fcooperate_delivery_company")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("cooperationExpress"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fdelivery_service")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("deliveryService"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fkpi")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("kpi"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fhigh_season_mechanism")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("highSeasonMechanism"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fcan_offer_surveillance_video")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canOfferSurveillanceVideo"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fcan_offer_product_insurance")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canOfferProductInsurance"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_overseas")
                .fieldName("fcan_offer_return")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canOfferReturn"))
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrmServiceProvider_t_merchants_service_inland(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fwarehouse_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("warehouseNature"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fcooperative_client")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("cooperativeClient"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("forder_cargo")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("orderCargo"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("findividuation_services")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("individuationServices"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fcooperative_express_company")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("cooperationExpress"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fdelivery_service")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("deliveryService"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fkpi")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("kpi"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fhigh_season_mechanism")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("highSeasonMechanism"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fcan_offer_surveillance_video")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canOfferSurveillanceVideo"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fcan_offer_product_insurance")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canOfferProductInsurance"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_inland")
                .fieldName("fcan_offer_return")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canOfferReturn"))
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrmServiceProvider_t_merchants_service_clearance(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_clearance")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_clearance")
                .fieldName("fadvantage_port")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("advantagePort"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_clearance")
                .fieldName("faeo_auth_level")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("aeoAuthLevel"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_clearance")
                .fieldName("fmain_clearance_product_scope")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("mainClearanceProductScope"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_clearance")
                .fieldName("fcan_pay_clearance")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canPayClearance"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_clearance")
                .fieldName("fexports_rise_product_type")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("exportsRiseProductType"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_clearance")
                .fieldName("fcan_handle_emergency")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("canHandleEmergency"))
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrmServiceProvider_t_merchants_service_agency(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("fservice_branch")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("serviceBranch"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("fadvantage_routes")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("advantageRoutes"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("faverage_time")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("averageTime"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("fmember")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("member"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("fcooperative_client")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("cooperativeClient"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("ftotal_shipments_gmv")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("totalShipmentsGmv"))
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_service_agency")
                .fieldName("fkpi")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_supplier_service_info_bg")
                .fieldName("biz_features")
                .build())
            .fieldCheckMethod(CustomizedMethod.builder()
                .beanName("containsJsonValue")
                .args(Arrays.asList("kpi"))
                .build())
            .build());
    }

    private void addMappingRuleForCbgSrmServiceProvider_t_merchants_business_info(MigrationConfig migrationConfig) {
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("fid")
                .isPrimaryKey(true)
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("fcompany_business")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_business_evaluation_info_bg")
                .fieldName("companyBusiness")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("fcompany_brief_introduction")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("company_brief_introduction")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("fcompany_scale")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_business_evaluation_info_bg")
                .fieldName("company_scale")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("fbusiness_configuration")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_business_evaluation_info_bg")
                .fieldName("businessConfiguration")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("fpractical_ability")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_business_evaluation_info_bg")
                .fieldName("practicalAbility")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("foperation_process")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_business_evaluation_info_bg")
                .fieldName("operationProcess")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("fbusiness_reputation")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_business_evaluation_info_bg")
                .fieldName("businessReputation")
                .build())
            .build());
        migrationConfig.addMappingRule(MappingRule.builder()
            .sourceMappingItem(SourceMappingItem.builder()
                .tableName("t_merchants_business_info")
                .fieldName("foperating_years")
                .build())
            .targetMappingItem(TargetMappingItem.builder()
                .tableName("t_company_info")
                .fieldName("operating_years")
                .build())
            .build());
    }
}
